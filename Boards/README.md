First run

```MergePBNFiles.exe -d -r .```

to gather all PBN-input in a new file. The new file will be All.PBN

The files are organised in different directories as there might be some processing before using the deal.

The rule is: If generated by selecting boards on a specific convention used by any of the players or random generated deals it can be used directly.

Now we want to bid all the boards using Bridge Bidding Analyzer (Or any software, that can produce bidding, that can be used for training), so first we translate the PBN-file to BBA-format using

```pbn2bba.exe All.pbn```

that will generate a file in BBA-format, input-YYYY-MM-DD.bba - and also print any duplicates

Now to speed up the process, we split the file in files with 200.000 deals, as we can run BBA on each file in paralel.

```python split_and_test_for_duplicates.py```

It will create files that can be used as input to BBA. (*.BBA)

```
input_1.bba
...
input_xx.bba
```

Copy these files to the BBA directory with the runBBA.cmd from this directory (Check the command executes the expected number of files)

So from the BBA-directory run

```
runBBA.cmd conventioncard
```

Where convention card will be taken from D:\GitHub\ben\BBA\
You should also check that the CC in use is present

Before running the command you must start BBA and select archive as PBN for one room.

When all hands are bid you create a new .PBN file with all the deals like this

```
type output*.pbn > GIBxxxx.pbn
```

or whatever name match the system used - xxx can be the version of BBA

As BBA have some pretty strange doubles, we filter the deals while converting ti to BEN-format

```
>python ..\src\pbn2ben_skip_doubled_making.py filename
```

It will print the bad deals like this:

```
EE883BBD9D85D914FF2E36B79BF8 W 5HX 11  -650
1C52474874D7CDABA958BC93A0C6 E 2SXX 10  -1040
074E7BADA6837DB8B59A9EEABD46 S 4SX 10  790
8521F1241E72C0FF824FF900A07E E 3DX 10  -870
CCE0B23514E56096152D193F3926 N 6SX 12  1210
D91292C5B6C66193BDB88C8C7F11 S 4SX 10  590
930AA0191ED8D6F3042661AD53EF E 2HX 8  -670
0AFB5B54BD2F449499BBE393C08B E 6HX 12  -1210
A80F233DFF7FF325D21016257551 N 7SX 13  1770
DAD6EFDD6659777FEC1144C7F12B W 4SX 10  -590
02CA0399CC620130FE832E9DE690 W 3CX 10  -570
52620EA474B784C429DC4CF8B8ED E 5CX 11  -550
4F0AC9C2C298694874624E2B82DF N 5HX 11  850
83718280968CF6374D7129A5589A S 2SX 8  670
6D1D2BD5A9A664C37D483ADC249A W 2DX 8  -180
6E53D75645CFF4AADC4CB46A10C2 W 7SX 13  -1770
CD43B24089EF958EE094D8D9A927 S 2SX 9  570
9483E8EACAF478427220CE788747 W 5SX 12  -750
```

So it can be tested in BBA.

Before we start the training we have yet a filter we want to apply using the par-score of the deals

So we execute 

```
python ..\scripts\training\bidding\badcontracts.py input.ben


Then run 
```pbn2ben.exe All.pbn```
to generate the file in BEN-format. This file is excluded from GitHub due to size. (Instead of pbn2ben.exe you can use pbn2ben.py from the src directory)

It might be an idea to set the right conventions in BBA, and just rebid all the hands with the right conventions.
Then BEN will be trianed with the right conventions, and not the bidding in the pbn-files. It is still possible to delete boards, that are impossible or just bad boards.

Now we need to translate the bidding into binary format, so the next step is:

```binfo_binary.exe input.ben data```

So we are now ready to train the models

```bidding_nn.exe data ..\models```
```binfo_nn.exe data ..\models```

The number of epcos are important, when training, and from 20 epocs (1 epoc is one full cucle thru the input data) it is acceptable results, but for production like neural nets it is recommended with about 200-500 epocs.
